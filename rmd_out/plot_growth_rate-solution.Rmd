---
output:
  pdf_document:
    latex_engine: xelatex
geometry: a4paper
---

# Plot growth rate - solution
*Po-Ju Ke*

``` rsplus
#### Plot the effect of growth rate on a population following discrete
     logistic growth ----
#### Author: Po-Ju Ke



#### Create the function ----
Logistic <- function(initial, growth, capacity, time){
  pop_size <- rep(initial, time)
  for(i in 2:time){
    pop_size[i] <- pop_size[i-1] * (1 + growth * (1 - (pop_size[i-1] / capacity)))
  }
  temp <- data.frame(Time = 1:time, 
                     Population = pop_size)
  return(temp)
}



#### Use the function to create three different simulations ----
out.1 <- Logistic(10, 0.6, 100, 40)
out.2 <- Logistic(10, 1.9, 100, 40)
out.3 <- Logistic(10, 2.7, 100, 40)



#### Find maximum population value for plotting ----
ymax <- max(out.1, out.2, out.3)



#### Plot and save the outcomes ----
pdf('DiscreteLogistic_XXXXXXXXXX.pdf', width = 3, height = 8)

par(mfrow = c(3, 1), mar = c(4.1, 4.1, 4.1, 2.1))
plot(Population ~ Time, out.1, type = "o", pch = 16, las = 1, ann = FALSE,
     ylim = c(0, ymax))
abline(h = 100, col = "grey", lty = 3)
title(main = "(a) r = 0.6", adj = 0)
title(ylab = "Population size")

plot(Population ~ Time, out.2, type = "o", pch = 16, las = 1, ann = FALSE,
     ylim = c(0, ymax))
abline(h = 100, col = "grey", lty = 3)
title(main = "(b) r = 1.9", adj = 0)
title(ylab = "Population size")

plot(Population ~ Time, out.3, type = "o", pch = 16, las = 1, ann = FALSE,
     ylim = c(0, ymax))
points(Population ~ Time, out.3[(out.3$Time > 5 & out.3$Population < 50), ],
       type = "p", pch = 16, col = "red")
abline(h = 100, col = "grey", lty = 3)
abline(h = 50, col = "red", lty = 3)
title(main = "(c) r = 2.7", adj = 0)
title(ylab = "Population size", xlab = "Time")

dev.off ()
```

The file with the final figure should look like this:

![](midterm_plot.pdf)
