====== Do the data fit to Benford's law? ======

Benford's law is an interesting mathematical phenomenon: in many real-world measured datasets, when we take the first digit of each measured value (i.e. the leftmost, regardless of the position of the decimal point), the most commonly occurring number will be 1, then 2 and so on, with decreasing frequency, with 9 being the least probable. See [[http://www.testingbenfordslaw.com|here]] for a nice website demonstrating Benford's law on different datasets, or [[https://en.wikipedia.org/wiki/Benford%27s_law|Wikipedia]] for the explanation of why this is happening, or, e.g. [[https://www.researchgate.net/profile/Andreas_Diekmann2/publication/24083679_Not_the_First_Digit_Using_Benford's_Law_to_Detect_Fraudulent_Scientif_ic_Data/links/553bb08b0cf29b5ee4b87ba9.pdf|this paper]], where authors extracted correlation coefficients from many different scientific studies to check whether they follow Benford's law (and then asked researchers to 'fake' data, i.e. generate random correlation coefficients, to show that 'fake' data do not obey Benford's law).


**What to do**
  * Prepare the function ''follow.benford (data)'', which will draw the barplot with frequencies of leading significant digits in the argument ''data'', where ''data'' is a vector of numbers (either integers or real numbers, including negative values). The same barplot will also include a comparison with empirical (expected) values derived from Benford's law (see below).
  * From each number in ''data'', extract the leading (leftmost) digit (not zero, not a decimal point, and not a minus sign!).
  * Count the frequency of individual digits (1-9, but not zero), and calculate the expected frequency of individual digits if they follow Benford's law: P (//d//) = log<sub>10</sub> ((//d//+1)///d//), where //d// is the digit (e.g. 1), and P(//d//) is the probability that this digit will be the leading digit in the dataset (see [[https://en.wikipedia.org/wiki/Benford%27s_law|Wikipedia]]). Simple calculation shows that P(1) = 0.301, P(2) = 0.176, P(3) = 0.125, ... P(9) = 0.046.
  * Test the function on the following two datasets (see examples of codes and results below): population sizes of 233 countries in the World (data from [[https://en.wikipedia.org/wiki/List_of_countries_by_population_(United_Nations)|Wikipedia]]), and measured leaf areas for 3427 leaves from different habitats (data from [[http://www.amjbot.org/content/99/11/1756.short|Blonder et al. (2016)]], available from the [[https://brianjenquist.wordpress.com/lab-data-and-code/#PLANT%20FUNCTIONAL%20TRAIT%20DATA|Dataset website of Brian Enquist]]). Note that below I prepared both datasets for easy download from Gist on Github.
  * **If you can find another real dataset which follows Benford's law and produce a reproducible script (including reproducible import of data) to prove it, you will get 50% of extra points!**

<code rsplus>
pop <- readr::read_delim ('https://gist.githubusercontent.com/zdealveindy/87f6ac90e989a1dc4c6b41ffd3230cce/raw/43f6261deb22cdf28e70e249c2934c22801483c8/population-of-countries-in-the-world.txt', delim = '\t')
follow.benford (pop$Population)
title (main = 'Population of countries in the World')
</code>
{{:recol:figures:pop-countries-world-benford.png?direct|}}
<code rsplus>
data.LA <- readr::read_delim ('https://gist.githubusercontent.com/zdealveindy/9efbebf002d3cccc7528be38309ffffb/raw/528a46e9d1b53821cf92354a5a548ee68bdcfee2/wet-dry-leaf-area.txt', delim = '\t')
follow.benford (data.LA$Wet.area.cm2)
title (main = 'Leaf area')
</code>
{{:recol:figures:leaf-area-blonder-benford.png?direct|}}

[[recol:exercise:benfords-law_solution|Solution]]